accelerator:
  displayName: Hello NodeJS
  description: A Node.js sample app
  iconUrl: https://images.freecreatives.com/wp-content/uploads/2015/05/smiley-559124_640.jpg
  tags:
  - nodejs
  - getting-started

  # options for the UI
  options:
  - name: includeTap
    label: "Include TAP deployment resources?"
    inputType: checkbox
    dataType: boolean
    defaultValue: no

  imports:
    - name: tap-workload

engine:
  merge:
    - include: [ "**" ]
      exclude: [ "package.json", "config/**", "catalog/**", "README.md", "DEPLOYING.md" ]

    - include: [ "package.json" ]
      chain:
      - type: ReplaceText
        substitutions:
        - text: hello-nodejs
          with: "#artifactId"

    - include: [ "config/workload.yaml" ]
      condition: "#includeTap"
      chain:
      - type: ReplaceText
        substitutions:
        - text: hello-nodejs
          with: "#artifactId"
      - merge:
          - type: InvokeFragment
            reference: tap-workload
          - include: [ "**" ]
        onConflict: UseFirst

    - include: [ "catalog/catalog-info.yaml" ]
      condition: "#includeTap"
      chain:
      - type: ReplaceText
        substitutions:
        - text: hello-nodejs
          with: "#artifactId"
          
    # - name: README
    #   type: Combo
    #   onConflict: Append
    #   merge:
    #   - include: [ "README.md"]
    #     chain:
    #     - type: ReplaceText
    #       substitutions:
    #       - text: hello-nodejs
    #         with: "#artifactId"
    #   - include: [ "DEPLOYING.md" ]
    #     condition: "#includeTap"
    #     chain:
    #     - type: ReplaceText
    #       substitutions:
    #       - text: hello-nodejs
    #         with: "#artifactId"
    #     - type: RewritePath
    #       rewriteTo: "'README.md'"

    - type: Provenance